# スプレッドシートの使い方（やさしいガイド）

このツールは、スプレッドシートの行ごとに Slack へ通知します。はじめての方でも迷わないよう、必要な列と書き方を丁寧にまとめました。

## 1. シートを開く
- 管理者が指定した「通知シート」を開きます（シート名は管理者に確認）。複数シートがある場合でも、ひとつずつ同じルールで入力します。

## 2. 入力する列（左からの順番）
1) 年 / 月 / 日  
   - 特定の日に送りたいときだけ入力します。分からないときは「指定なし」と書いたままでOKです。
2) 時刻（必須）  
   - 送信したい時刻を入力します。例: `9:00` や `17:30`  
   - セルをクリックすると時計マークの入力補助が出ることが多いです。
3) 曜日（7列のチェックボックス）  
   - 日を「指定なし」にした場合のみ使います。送りたい曜日にチェックを入れてください。
4) 土日祝を許可（チェックボックス）  
   - チェックを入れると土日祝も送信します。入れないと土日祝はスキップします。
5) Slackチャンネル（必須）  
   - 例: `general` と入力すれば送信時に自動で `#general` になります。チャンネルID `C...` 形式ならそのまま書けます（シート表示形式では `#` を付けていません）。
6) 宛先（任意）  
   - 通知にメンションを付けたいときに入力します。カンマで区切れば複数指定できます。  
   - 例: `here` / `channel` / `alice`（@なしの名前） / `U123ABC`（ユーザーID） / `<@U123ABC>`  
   - 名前は `@` を付けずに入力してください（`@name` と書くと `@@name` になります）。IDは `U123ABC` または `<@U123ABC>` と書けます。シートの表示形式で `@` を自動表示することはありません。  
   - カンマの後に改行やスペースが入っても問題ありません。
7) 通知内容（必須）  
   - Slack に送る本文を書きます。
8) 登録者（任意）  
   - エラーで送れなかったとき、ここに書いたユーザーへDM送信を試みます。  
   - 名前は `@` を付けずに入力してください（`alice` など）。IDの場合は `U123ABC` または `<@U123ABC>` と書けます。`@name` と書くと `@@name` になってしまいます。シートの表示形式で `@` を自動表示することはありません。

## 3. 送信される条件のまとめ
- 年/月/日すべて入力: 当日のその時刻に1回だけ送信（当日以外はスキップ）。
- 年なし・月なし・日あり: 毎月その日・その時刻に送信（年/月は現在値を使います）。
- 年なし・月あり・日あり: 毎年その月その日・その時刻に送信。
- 年あり・月なし・日あり: 毎月その日・その時刻に送信（年指定は実質効きません）。
- 日を「指定なし」: 曜日チェックが入っている日だけ、その時刻に送信（年/月を入れるとその年/月に限定されるので通常は空のままで）。
- 「土日祝を許可」にチェックがない場合、土日祝は送られません。
- 時刻が空・文字列などで正しくない場合、必須列（チャンネル・通知内容）が空の場合はスキップされます。

## 4. よくあるミスと対処
- **カンマを入れずに宛先を改行だけで複数書いた** → 1つの宛先として扱われます。複数なら必ずカンマで区切ってください。  
- **チャンネルを忘れた** → その行はスキップされます。`#channel` を必ず入れてください。  
- **時間を文字で書いた（例: “朝9時”）** → 時刻として認識されずスキップされます。`9:00` のように入力してください。

## 5. 困ったときは
- 送られない場合は、必須列（時刻・チャンネル・通知内容）が入っているか、日付/曜日の条件に合っているか、土日祝の設定を確認してください。
- やり方に自信がない場合は、同じ行をコピーして内容だけ変えると安全です。
- 何度か試してうまくいかない場合は、登録者や管理者に「この行のどこが足りないか」を共有して相談してください。
